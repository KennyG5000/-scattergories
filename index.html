<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Scattergories Timer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 2vh;
      margin: 0;
      background-color: #f0f0f0;
      box-sizing: border-box;
    }

    h1 {
      font-size: 5vw;
    }

    #letter {
      font-size: 15vw;
      margin: 2vh 0;
    }

    #timer {
      font-size: 10vw;
      margin: 2vh 0;
    }

    ul#categories {
      list-style: none;
      padding: 0;
      margin: 2vh auto;
      width: 90vw;
      font-size: 4vw;
    }

    li {
      padding: 1vh 0;
      word-wrap: break-word;
      white-space: normal;
    }

    button {
      font-size: 4vw;
      padding: 1vh 2vw;
      margin-top: 2vh;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Scattergories</h1>
  <div id="letter">?</div>
  <div id="timer">120</div>
  <ul id="categories"></ul>
  <button onclick="startGame()">Start Game</button>

  <script>
    const allCategories = [
      "Boy's Name",
      "Girl's Name",
      "Country",
      "Animal",
      "Food",
      "Movie Title",
      "Book Title",
      "City",
      "TV Show",
      "Famous Person",
      "Clothing",
      "Sport"
      // Add more categories here!
    ];

    const allowedLetters = [
      "A", "B", "C", "D", "E", "F", "G", "H", "I", "J",
      "K", "L", "M", "N", "O", "P", "R", "S", "T", "W"
    ];

    let usedLetters = [];
    let usedCategorySets = [];
    let currentRound = 0;
    let timerInterval;

    function getUniqueLetter() {
      const available = allowedLetters.filter(l => !usedLetters.includes(l));
      if (available.length === 0) usedLetters = []; // Reset if all used
      const letter = available[Math.floor(Math.random() * available.length)];
      usedLetters.push(letter);
      return letter;
    }

    function getUniqueCategories(allCats, count = 12) {
      const maxAttempts = 10;
      let attempt = 0;
      let selected;
      do {
        selected = allCats
          .slice()
          .sort(() => Math.random() - 0.5)
          .slice(0, count);
        attempt++;
      } while (
        usedCategorySets.some(set => arraysEqual(set, selected)) &&
        attempt < maxAttempts
      );
      usedCategorySets.push(selected);
      return selected;
    }

    function arraysEqual(a, b) {
      if (a.length !== b.length) return false;
      return a.every((val, i) => val === b[i]);
    }

    function startGame() {
      if (currentRound >= 3) {
        usedLetters = [];
        usedCategorySets = [];
        currentRound = 0;
      }

      currentRound++;

      const letter = getUniqueLetter();
      const categories = getUniqueCategories(allCategories, 12);

      document.getElementById("letter").textContent = letter;

      const list = document.getElementById("categories");
      list.innerHTML = "";
      categories.forEach(cat => {
        const li = document.createElement("li");
        li.textContent = cat;
        list.appendChild(li);
      });

      startTimer();
    }

    function startTimer() {
      clearInterval(timerInterval);
      let timeLeft = 120;
      const timerDisplay = document.getElementById("timer");
      timerDisplay.textContent = timeLeft;

      timerInterval = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
        }
      }, 1000);
    }
  </script>
</body>
</html>
