<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Scattergories Game</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      overflow: hidden;
    }

    #app {
      display: flex;
      flex-direction: column;
      height: 100%;
      width: 100%;
      box-sizing: border-box;
      padding: 2vh 2vw;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    #round-info {
      font-size: 3.5vw;
    }

    #start-btn {
      font-size: 2.5vw;
      padding: 1vh 2vw;
      cursor: pointer;
    }

    .main-info {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 2vh 0;
      gap: 4vw;
    }

    #letter {
      font-size: 14vw;
      font-weight: bold;
    }

    #timer {
      font-size: 10vw;
    }

    #categories {
      flex: 1;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: flex-start;
      overflow-y: auto;
      gap: 1vh 2vw;
      padding: 1vh 0;
    }

    .category {
      font-size: 3.5vw;
      flex: 1 1 calc(25% - 2vw);
      text-align: center;
      padding: 0.5vh;
      box-sizing: border-box;
      word-wrap: break-word;
    }

    @media (max-aspect-ratio: 4/3) {
      #letter {
        font-size: 10vw;
      }

      #timer {
        font-size: 7vw;
      }

      .category {
        font-size: 4.5vw;
        flex: 1 1 calc(33% - 2vw);
      }

      #start-btn {
        font-size: 3.5vw;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="header">
      <div id="round-info">Round 1 of 3</div>
      <button id="start-btn" onclick="startGame()">Start Game</button>
    </div>

    <div class="main-info">
      <div id="letter">?</div>
      <div id="timer">120</div>
    </div>

    <div id="categories"></div>
  </div>

  <script>
    const allCategories = [
      "Boy's Name", "Girl's Name", "Country", "Animal", "Food",
      "Movie Title", "Book Title", "City", "TV Show", "Famous Person",
      "Clothing", "Sport"
      // Add more if needed
    ];

    const allowedLetters = [
      "A", "B", "C", "D", "E", "F", "G", "H", "I", "J",
      "K", "L", "M", "N", "O", "P", "R", "S", "T", "W"
    ];

    let usedLetters = [];
    let usedCategorySets = [];
    let currentRound = 0;
    let timerInterval;

    function getUniqueLetter() {
      const available = allowedLetters.filter(l => !usedLetters.includes(l));
      if (available.length === 0) usedLetters = [];
      const letter = available[Math.floor(Math.random() * available.length)];
      usedLetters.push(letter);
      return letter;
    }

    function getUniqueCategories(count = 12) {
      let selected;
      let attempt = 0;
      do {
        selected = allCategories
          .slice()
          .sort(() => 0.5 - Math.random())
          .slice(0, count);
        attempt++;
      } while (
        usedCategorySets.some(set => arraysEqual(set, selected)) &&
        attempt < 10
      );
      usedCategorySets.push(selected);
      return selected;
    }

    function arraysEqual(a, b) {
      return a.length === b.length && a.every((val, i) => val === b[i]);
    }

    function startGame() {
      if (currentRound >= 3) {
        currentRound = 0;
        usedLetters = [];
        usedCategorySets = [];
      }

      currentRound++;
      document.getElementById("round-info").textContent = `Round ${currentRound} of 3`;

      const letter = getUniqueLetter();
      document.getElementById("letter").textContent = letter;

      const categories = getUniqueCategories(12);
      const categoryContainer = document.getElementById("categories");
      categoryContainer.innerHTML = "";
      categories.forEach(cat => {
        const div = document.createElement("div");
        div.className = "category";
        div.textContent = cat;
        categoryContainer.appendChild(div);
      });

      updateButtonText();
      startTimer();
    }

    function updateButtonText() {
      const button = document.getElementById("start-btn");
      if (currentRound === 1) {
        button.textContent = "Next Round";
      } else if (currentRound === 2) {
        button.textContent = "Final Round";
      } else if (currentRound === 3) {
        button.textContent = "Restart Game";
      }
    }

    function startTimer() {
      clearInterval(timerInterval);
      let timeLeft = 120;
      const timerDisplay = document.getElementById("timer");
      timerDisplay.textContent = timeLeft;

      timerInterval = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
        }
      }, 1000);
    }
  </script>
</body>
</html>
